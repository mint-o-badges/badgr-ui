<form-message></form-message>

<div class="oeb page-padding">
	<ng-template [showLoader]="true" [bgAwaitPromises]="[learningPathsLoaded, issuersLoaded]">
		<div class="oeb-section-sm">
			<div class="oeb-headline-container tw-relative">
				<div class="tw-z-10 tw-relative">
					<h1 hlmH1 class="tw-text-purple tw-font-extrabold">{{ 'LearningPath.catalogHeadline' | translate }}</h1>
				</div>
			</div>
		</div>

		<div class="tw-relative">
			<section class="">
				<div class="tw-flex tw-items-center oeb-standard-padding-bottom tw-flex-wrap">
					<div class="tw-flex tw-gap-4 tw-items-center">
						<div class="tw-pb-2 md:tw-pb-0 ">
							<input type="text" name="forminput" changeOrder
								class="tw-w-[300px] tw-border-solid tw-border-purple tw-bg-white tw-mr-6"
								placeholder="{{ 'LearningPath.searchLearningPaths' | translate }}" [(ngModel)]="searchQuery"
								hlmInput />

						</div>
						<oeb-checkbox
								[text]="'Nach Institutionen gruppieren' "
								name="'groupByInstitution'"
								[(ngModel)]="groupByInstitution"
								>
						</oeb-checkbox>
					</div>
				</div>
				<ng-container>
					<div class="tw-grid tw-grid-cols-learningpaths tw-gap-16">
						<bg-learningpathcard *ngFor="let lp of learningPaths"
						[badgeImage]="baseUrl + lp._apiModel.participationBadge_image" [name]="lp.name" [issuerTitle]="lp.issuer_name" [description]="lp.description" [tags]="lp.tags" ></bg-learningpathcard>
					</div>
				</ng-container>
			</section>
		</div>
		<ng-container *ngIf="groupByInstitution">
			<ng-container *ngFor="let issuerGroup of learningPathResultsByIssuer">
				<h3 class="u-text-h3-semibold u-margin-bottom2x u-margin-top6x u-text-dark1">
					{{ issuerGroup.issuerName }}
					<span class="u-text-small-semibold-caps u-text-dark4 u-margin-left2x">{{
						issuerGroup.learningpaths.length }}
						{{ issuerGroup.learningpaths.length == 1 ? 'LearningPath' : 'LearningPaths' }}</span>
				</h3>
				<div class="tw-grid tw-grid-cols-badges tw-gap-16">
					<div *ngFor="let lp of issuerGroup.learningpaths">
						<span>{{lp.name}}</span>
					</div>
					<!-- TODO: Fix the badgecard link for sharing and routing -->
					<!-- <bg-badgecard *ngFor="let badge of issuerGroup.badges" [badgeTitle]="badge.name"
						[badgeImage]="badge.image" [badgeDescription]="badge.description"
						[badgeSlug]="badge.slug"
						[issuerTitle]="badge.issuerName ? badge.issuerName : badge.issuer.name"
						[badgeIssueDate]="badge.createdAt" public="true" [publicUrl]="badge.url"
						[badgeClass]="true"></bg-badgecard> -->
				</div>
			</ng-container>
		</ng-container>
	</ng-template>
</div>