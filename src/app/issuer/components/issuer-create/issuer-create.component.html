<div class="tw-relative tw-w-full">
	<div class="oeb page-padding">
		<form-message></form-message>

		<div class="oeb-headline-container-sm">
			<h1 hlmH1 class="tw-text-purple">{{ 'Issuer.createInstitution' | translate }}</h1>
			<p hlmP class="tw-font-normal">{{ 'Issuer.awardBadeges' | translate }}</p>
		</div>

		<form (ngSubmit)="onSubmit()" class="tw-max-w-fit tw-w-full tw-mt-6" novalidate>
			<bg-formfield-image
				#imageField
				label="{{ 'Issuer.imageOptional' | translate }}"
				imageLoaderName="issuer"
				[placeholderImage]="issuerImagePlacholderUrl"
				[control]="issuerForm.rawControlMap.issuer_image"
			></bg-formfield-image>

			<oeb-input
				label="{{ 'General.name' | translate }}"
				[control]="issuerForm.rawControlMap.issuer_name"
				[fieldType]="'text'"
				[autofocus]="true"
				errorMessage="{{ 'Issuer.enterName' | translate }}"
				#issuer_name_field
			></oeb-input>

			<oeb-input
				[label]="'Website URL'"
				[control]="issuerForm.rawControlMap.issuer_url"
				[urlField]="true"
				[fieldType]="'url'"
				errorMessage="{{ 'Issuer.enterURL' | translate }}"
				#issuer_url_field
			></oeb-input>

			<!-- margin added temporary till select component is ready -->
			<bg-formfield-select
				class="u-margin-bottom2x tw-mt-6"
				[control]="issuerForm.rawControlMap.issuer_email"
				label="{{ 'General.contact' | translate }} E-Mail"
				placeholder="{{ 'Issuer.enterValidEmail' | translate }}"
				[options]="emailsOptions"
				errorMessage="{{ 'Issuer.enterValidEmail' | translate }}"
			></bg-formfield-select>

			<oeb-input
				label="{{ 'General.description' | translate }}"
				[control]="issuerForm.rawControlMap.issuer_description"
				[fieldType]="'textarea'"
				errorMessage="{{ 'Issuer.enterDescription' | translate }}"
				#issuer_description_field
			></oeb-input>

			<!-- margin added temporary till select component is ready -->
			<bg-formfield-select
				class="u-margin-bottom2x tw-mt-6"
				[control]="issuerForm.rawControlMap.issuer_category"
				label="{{ 'General.category' | translate }}"
				placeholder="{{ 'Issuer.enterCategory' | translate }}"
				[options]="[
					{
						label: 'Schule (Grundschulen, weiterführende Schulen, Berufsschulen, Institutionen formaler schulischer Bildung)',
						value: 'schule'
					},
					{
						label: 'Hochschule (Universitäten. Fachhochschulen, ...)',
						value: 'hochschule'
					},
					{
						label: 'Andere (Bibliotheken, Museen, FabLabs, Unternehmen, Vereine, ...)',
						value: 'andere'
					}
				]"
			></bg-formfield-select>

			<h3 hlmH3 class="tw-font-bold tw-text-oebblack tw-mt-12">{{ 'General.address' | translate }}</h3>

			<oeb-input
				label="{{ 'General.street' | translate }}"
				[control]="issuerForm.rawControlMap.issuer_street"
				[fieldType]="'text'"
				errorMessage="{{ 'Issuer.enterStreet' | translate }}"
				#issuer_street_field
			></oeb-input>

			<oeb-input
				label="{{ 'Issuer.houseNo' | translate }}"
				[control]="issuerForm.rawControlMap.issuer_streetnumber"
				[fieldType]="'number'"
				errorMessage="{{ 'Issuer.enterHouseNo' | translate }}"
				#issuer_streetnumber_field
			></oeb-input>

			<oeb-input
				class="oeb-input-hide-arrows"
				label="{{ 'General.postalCode' | translate }}"
				[control]="issuerForm.rawControlMap.issuer_zip"
				[fieldType]="'number'"
				errorMessage="{{ 'Issuer.enterPostalCode' | translate }}"
				#issuer_zip_field
			></oeb-input>

			<oeb-input
				label="{{ 'General.city' | translate }}"
				[control]="issuerForm.rawControlMap.issuer_city"
				[fieldType]="'text'"
				errorMessage="{{ 'Issuer.enterCity' | translate }}"
				#issuer_city_field
			></oeb-input>

			<div class="tw-mt-6">
				<form>
					<altcha-widget auto="onfocus" id="altcha"></altcha-widget>
				</form>
			</div>

			<label
				[class.checkbox-is-error]="
					issuerForm.rawControlMap.agreedTerms.dirty && !issuerForm.rawControlMap.agreedTerms.valid
				"
				*ngIf="dataProcessorUrl"
				class="checkbox l-marginBottom-2x"
				for="terms"
			>
				<input name="terms" id="terms" type="checkbox" [formControl]="issuerForm.rawControlMap.agreedTerms" />
				<span class="checkbox-x-text"
					>Ich habe die <a target="_blank" [href]="dataProcessorUrl">Datenschutzrichtlinien</a> gelesen und
					stimme ihnen zu.
					<div
						*ngIf="
							issuerForm.rawControlMap.agreedTerms.dirty && !issuerForm.rawControlMap.agreedTerms.valid
						"
						class="checkbox-x-errortext"
					>
						{{ 'Issuer.readPolicy' | translate }}
					</div>
				</span>
			</label>

			<div class="tw-flex tw-justify-start tw-flex-wrap sm:tw-flex-nowrap tw-gap-2 tw-mt-4">
				<oeb-button
					class="tw-mr-4"
					variant="secondary"
					[routerLink]="['/issuer']"
					[disabled-when-requesting]="true"
					text="{{ 'General.cancel' | translate }}"
				></oeb-button>

				<oeb-button
					type="submit"
					width="max_content"
					[disabled]="!!addIssuerFinished"
					text="{{ 'Issuer.createInstitution' | translate }}"
					[loading-promises]="[addIssuerFinished]"
					loading-message="Hinzufügen"
				>
				</oeb-button>
			</div>
		</form>
	</div>
</div>
